<div class="container">
  <div class="row">
    <div class="span9">
      <h1><%= @user.name %></h1>
      <h2><%= @user.email %></h2>
      <%= error_messages_for(@design) %>
      <% if @user.name == session[:user_name] %>
        <div id="upload_design">

        <%= form_for [@user,@design],:html => {:multitype => true } do |f| %>
          <%= render 'shared/error_messages',object: f.object %>
        <%= f.label :image,"图片地址" %>
        <%= f.file_field :image %>
        <%= f.label :title,"设计标题" %>
        <%= f.text_field :title %>
        <%= f.label :collection_id,"所属专辑" %>
        <%= f.select :collection_id,@user.collections.all.collect{|s| [s.name,s.id]} %>
        <!-- Link to trigger modal -->
        <p><a href="#newCollection" role="button" class="" data-toggle="modal">新建专辑</a></p>
        <%= f.label :category_id,"请选择分类目录" %>
        <%= f.select :category_id,Category.all.collect{|s| [s.name,s.id]},{:include_blank => true} %><br>
        <%= f.label :tag_id,"设置标签" %>
        <% Tag.all.each do |tag| %>
          <%= check_box_tag "design[tag_ids][]",tag.id,@design.tags.include?(tag) %>
        <%= tag.name %>
      <% end %>
        <br>
        <%= f.submit "上传设计",class:"btn btn-large btn-primary" %>
      <% end %>
      </div>
    <% end %>
    </div>
    <div class="span3">
      <%= render partial:"shared/user_side",locals:{:user => @user} %>
    </div>
  </div>
</div>


<!-- Modal -->
<div id="newCollection" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="false" style="display: block; ">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">新增专辑</h3>
  </div>
  <div class="modal-body">

    <% if @user.name == session[:user_name] %>
      <%= form_for [@user,@collection] do |f| %>
      <%= f.label :name,"专辑名称" %>
    <%= f.text_field :name %>
    <%= f.submit "保存" %>
  <% end %>
  <% end %>

  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal">Close</button>
    <button class="btn btn-primary">Save changes</button>
  </div>
</div>

<script type="text/javascript">
//$("#newCollection").modal()                       // initialized with defaults
</script>
